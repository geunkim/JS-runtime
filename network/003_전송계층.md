## 전송계층   
### 다중화와 역다중화   
+ 다중화 :   
   여러개의 채널을 하나의 채널로 통합하는 것. 송신 측에서 응용계층의 메세지를 데이타그램으로 만들어 전송계층으로 보내는 것     
+ 역다중화 :      
   하나의 채널을 원래의 여러 채널로 복귀 시키는것. 수신 측에서 응용계층으로 알맞은 소켓으로 데이타그램을 메세지로 바꾸어 보내는 것
    
### UDP   
: 최소 기능의 전송 계층 프로토콜로 다중화와 역다중화 기능에 아주 단순한 오류 검층 정정 기능인 체크섬만 있다   
+ 비연결형이기에 연결 유지를 위한 추가비용 없음   
+ 헤더크기가 8바이트 밖에 안될 정도로 작아 실시간 혹은 그에 가까운 선응이 필요한 앱에서는 유용하다 
+ 혼잡제어가 없기에 네트워크 성능이 떨어지고 데이터가 공평하게 나눠지지 않는다

**헤더 구성**   
+ 송신 포트 번호(16비트) | 수신 포트 번호(16비트)
+ 총 길이(16비트) | 데이터갯수 확인용 체크섬(16비트)
+ 데이터        
   
### TCP   
다중화와 역다중화 기능과 더불터 신뢰성 있는 데이터 전송, 혼잡제어, 흐름제어 기능등을 제공하는 프로토콜이다
**헤더 구성**   
+ 송신포트번호(16비트) | 수신포트번호(16비트)   
+ 보내는 데이터의 시작 인덱스 순서번호(32비트)   
+ 받을 데이터의 시작 인덴스 확인응답번호(32비트)
+ TCP에서 데이터필드 시작 부분 데이터오프셋(4비트) | 아직 사용하지는 않지만 미래에 사용될 reserved (3비트) |   
+ 악의적인 ECE 방어 NS(1비트) | 수신 윈도우를 축소했다는 의미 CWR(1비트) | 혼잡하니 제어해야한다 ECE(1비트) |       
+ 긴급처리 데이터 존재 URG (1비트) | 확인응답번호 설정됨 ACK (1비트) | 버퍼가 채워지지 않고 바로 보내기 PSH (1비트) |      
+ 이상신호로 연결 중단 PST(1비트 ) | 연결 초기화 순서번호 SYN (1비트) | 끝내기 FIN (1비트) |   
+ 데이터 갯수 확인요 체크섬(16비트) | URG가 설정됐을 때 긴급하게 보낼 데이터가 있는 위치인 긴급 포인터(16비트)
+ 기능 확장용 옵션(0 ~ 320비트) | 쪽 맞추기 패딩

> 헤더의 채워진 reserve 4번째 줄 간단 요약
> 
> 123번째 : 혼잡제어와 흐름제어와 연관 (악의 있다, 수신 윈도우 축소했다, 지금 혼잡하다)   
> 456번째 : 데이터 처리의 설정과 연관 (긴급한 데이터 있다, 받아야할 번호다, 버퍼에서 대기말고 바로 보내라)   
> 789번째 : 연결과 연관(연결중지한다, 연결시작한다, 연결끝낸다)   

#### 신뢰성 있는 데이터 전송   
양방향으로 동시에 데이터가 전송될 수 있는 전이중 서비스를 제공한다. 따라서 데이터의 순서와 확인을 보장하는 신뢰성 있는 데이터 전송을 보장한다   
+ 쓰리 웨이 헨드쉐이크 :
  연결을 설정하는 과정에서 총 3개의 패킷을 송수신하는 단계
```
1. syn = 1, ack = 0 (ece = 1)
2. syn = 1, ack = 1 (ece = 1)
3. syn = 0, ack = 1
```  
+ 그레이스 풀 :
  연결을 끝내기전 송신에서 4번의  패킷이 송수신되는 단계  
```
1. fin = 1, ack = 0
2. fin = 0, ack = 1

3. fin = 1, ack = 0 
4. fin = 0, ack = 1
```
#### 흐름제어와 혼잡제어   
+ 흐름제어 :
  종단점의 수신 버퍼의 여유 공간을 알려주어 통신중 버퍼플로우가 일어나는 것을 제어해주는 것이다. 이때 TCP의 윈도우가 수신 버퍼의 여유공간을 알려주는 용도로 사용된다.  
+ 혼잡제어 :
  손실된 세그먼트로부터 네트워크가 혼잡하다는 것을 알아채어 전송률을 조절하는 것
**혼잡시 세그먼트**
```
혼잡하다는 걸 감지한 송신측
ece = 1 cwr = 0
혼잡하다는 걸 받았던 송신측
ece = 1 cwr = 1
```
