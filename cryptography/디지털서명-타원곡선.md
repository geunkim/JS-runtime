## 디지털 서명 - 타원곡선

+ **디지털 서명이란** : 사칭 방지, 행동에 대한 부인 방지등 데이터의 무결성을 보장하기 위해 사용되는 암호시스템을 활용한 서명 시스템이다

### 디지털 서명 - 타원곡선 이 데이터의 무결성을 보장할 수 있는 이유

디지털 서명(타원곡선)이 데이터의 무결성을 보장할 수 있는 이유는 해당 디지털 서명에 활용된 암호 시스템인 **공개키 암호 시스템**의 성질 때문이다 

#### 공개키 암호 시스템의 성질

공개키 암호 시스템은 **이산로그 문제**를 기반으로 만들어지긴 시스템이다

+ **이산로그 문제**는 어떤 수의 제곱수를 구하는 것은 쉽지만, 그 제곱수의 어떤 수 지수를 구하는 것은 어려운 문제를 가리킨다

**즉, 만약 어떤 이산로그를 비밀키로 만들어버리면 그 이산로그의 공개키를 가진 누군가가 쉽게 비밀키를 알게되는 일이 발생하기 어렵다**

+ 덧붙여 이산로그가 존재하기 위해서는 기본적으로 이산로그와 이산제곱이 **일대일 대응**이여야 하므로, 해당 비밀키와 공개키는 오직 한쌍 밖에 존재하지 않는다

**즉, 공개키와 통하는 또 다른 비밀키를 찾아 해당 비밀키로 비밀키 주인을 사칭하는 일이 발생할 수가 없다**

> 정리하면 공개키 암호 시스템이 가지는 이산로그 문제의 유일성 덕분에 디지털 서명 시스템을 만들어 데이터의 무결성을 만들 수 있다.

### 디지털 서명이 데이터의 무결성을 보장하는 방법 

디지털 서명 - 타원곡선이 데이터의 무결성을 보장하는 방법은 비교가 되는 1차 서명을 먼저 만들고,  1차 서명, 문서의 해시값, 비밀키를 통해 2차 서명을 

만들어 데이터의 무결성을 보장한다. 이르 이해하기 위해 디지털 서명의 생성 방법과 검증 방법에 대해 알 필요가 있다

#### 디지털 서명 생성 방법

1. 비밀키로 생성점의 스칼라배에 사용되는 무작위 정수와, 공개키로 생성점, 생성점의 스칼라배 비밀키로 만든 어떠한 점, 생성점이 존재하기 위한 타원곡선의 계수를 

   구한다

2. 또 다른 무작위 정수를 생성점의 스칼라배 하여 또 다른 점을 구하고, 그 점의 x좌표에 모듈러 연산을 가한다.

   > 이것이 1차 서명이 된다. 1차 서명은 x좌표가 되며 생성점이 있는 타원곡선의 또다른 점이 된다

3. 1차서명에 비밀키를 곱하고 해당 중간값에 문서의 해시값을 더한 후 마지막에 무작위 정수의 역수를 곱하여 모듈러연산을 하여 2차 서명을 구한다

   > (H + s1*r) * (d^(-1)) = s2

4. 이렇게 구한 값인 (문서, 1차 서명, 2차 서명)을 보낸다 

#### 서명 검증 방법

1. 검증할 대상은 수신자가 받은 공개키와 문서, 2차서명을 통해 1차 서명을 복원할 수 있는 지 검증하는 거다

2. 문서의 해시값을 2차 서명으로 나눈 a을 구하고, 1차 서명을 2차 서명으로 나눈 b를 구한다

   > a = H * s2^(-1)

   > b = s1 * s1^(-1)

3. a * (생성점) + b * (또 다른 생성점) 인 타원곡선 덧셈 연산을 하여 점을 생성하고 모듈러 연산하여 1차서명과 동등하게 나오면 검증이 된다

> 정리하면 서명 검증은 1차 서명을 복원한 것이 된다

해당 내용이 시사하는 바는 2차 서명을 만들 때에 데이터와 비밀키가 사용된다는 것이다.

따라서 데이터가 중간에 바뀌어졌다면, 1차 서명을 복원할 때 올바르게 되지 않아 데이터의 **무결성을 확인**할 수 있고

다른 키의 사용자가 공개키의 주인마냥 행세해도, 사용된 비밀키가 다르기에 1차 서명 복원시 올바르게 되지 않아 **사칭방지와 부인방지**를 할 수 있다 